{% extends "core/base.html" %}

{% block title %}D3 Chart{% endblock %}

{% block content %}
<!-- Header Section -->
<header class="bg-dark py-5">
    <div class="container px-5">
        <div class="row gx-5 justify-content-center">
            <div class="col-lg-6">
                <div class="text-center my-5">
                    <h1 class="display-5 fw-bolder text-white mb-2">Sample Web and REST API Django Project</h1>
                    <p class="lead text-white-50 mb-4">
                        This is a Django-based web and REST API project that demonstrates the use of a D3.js chart after successful login and JWT-based authentication for secure data retrieval via REST API endpoints.
                    </p>
                    <div class="d-grid gap-3 d-sm-flex justify-content-sm-center">
                        <a class="btn btn-primary btn-lg px-4 me-sm-3" href="#features">Get Started</a>
                        <a class="btn btn-outline-light btn-lg px-4" href="#!">Learn More</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- D3 Chart Section -->
<section class="py-5 border-bottom">
    <div class="container px-5 my-5 px-5">
        <div class="text-center mb-5">
            <h2 class="fw-bolder">D3 Chart</h2>
            <p class="lead mb-0">Dynamic Data Visualization</p>
        </div>
        <div class="d-flex justify-content-center">
            <div id="chart-container"></div>
        </div>
        
    </div>
</section>
{% endblock %}

{% block extra_js %}
<!-- Include D3.js -->
<script src="https://d3js.org/d3.v7.min.js"></script>
<script>
    // Access the data passed from Django
    const data = {{ chart_data|safe }}; // 'safe' allows Django to insert the list without escaping

    const width = 500;
    const height = 300;

    const svg = d3.select("#chart-container")
                  .append("svg")
                  .attr("width", width)
                  .attr("height", height);

    svg.selectAll("rect")
       .data(data)
       .enter()
       .append("rect")
       .attr("x", (d, i) => i * 30)
       .attr("y", d => height - d)
       .attr("width", 25)
       .attr("height", d => d)
       .attr("fill", "steelblue");
</script>
{% endblock %}
